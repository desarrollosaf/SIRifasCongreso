<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<div class="row">
  <div class="col-md-12 stretch-card">
    <div class="card">
      <div class="card-body">
       
        @if(!mostrarCalendario){
            <h6 class="card-title text-center">
                CITAS 
            </h6>
            <div class="d-flex justify-content-center">
                <div style="width: 1300px;">
                <div class="calendar-wrapper">
                    <full-calendar #fullcalendar [options]="calendarOptions"></full-calendar>
                </div>
                </div>
            </div>   
        
         }@else{
              <div class="container">
                <div class="row w-100 mx-0 auth-page">
                    <div class="mx-auto">
   
                        <h3 class="text-center mb-4">Indicaciones para su cita</h3>
                        <p class="text-center text-muted mb-4">Antes de acudir, es indispensable que siga cuidadosamente las siguientes instrucciones:</p>


                        <!-- <div class="mb-4">
                            <h5>Procedimiento General</h5>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check-circle"></i> El personal del laboratorio le tomará una muestra de sangre de un brazo.</li>
                            </ul>
                        </div> -->

                        <!-- Check Up Médico -->
                        <div class="mb-4">
                            <h5>Para Check Up Médico</h5>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check-circle"></i> En las 48 horas previas: No haber tenido relaciones, no haber realizado duchas vaginales, no haberse aplicado ningún tratamiento médico vaginal (óvulos, cremas o pomadas).</li>
                               
                            </ul>
                        </div>

                        <!-- Antígeno Prostático Específico (PSA) -->
                        <!-- <div class="mb-4">
                            <h5>Para Antígeno Prostático Específico (PSA)</h5>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check-circle"></i> Abstinencia sexual y evitar eyaculación durante 48 horas previas al estudio.</li>
                                <li><i class="bi bi-check-circle"></i> Evitar ejercicio intenso 48 horas previas al estudio (ciclismo, motociclismo).</li>
                                <li><i class="bi bi-check-circle"></i> Realizar la prueba previo al estudio de ultrasonido prostático o manipulación prostática (tacto, masaje, citoscopía).</li>
                                <li><i class="bi bi-check-circle"></i> Indicar si hubo consumo de algún medicamento.</li>
                            </ul>
                        </div> -->

                        <!-- Tabla de citas -->
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">Folio</th>
                                        <th class="text-center">Nombre</th>
                                        <th class="text-center">Correo</th>
                                        <th class="text-center">Teléfono</th>
                                        <th class="text-center">Fecha cita</th>
                                        <th class="text-center">PDF</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-active">
                                        <td class="text-center">{{ datosCita.citas[0]?.folio }}</td>
                                        <td class="text-center">{{ datosCita.datosUser[0]?.Nombre }}</td>
                                        <td class="text-center">{{ datosCita.citas[0]?.correo }}</td>
                                        <td class="text-center">{{ datosCita.citas[0]?.telefono }}</td>
                                        <td class="text-center">{{ datosCita.citas[0]?.fecha_cita }}</td>
                                        <td class="text-center"><a [href]="'https://jornadasalud.congresoedomex.gob.mx/backend/' + datosCita.citas[0]?.path" target="_blank" rel="noopener noreferrer">
                                            <i class="bi bi-file-earmark-pdf-fill text-danger" style="font-size: 1.5rem;"></i>
                                        </a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                           
                    </div>
                </div>
            </div>

         }

         <ng-template #xlModal let-modal>
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"></h5>
                    <button type="button" class="btn-close" (click)="modal.close('by: close icon')" aria-label="Close"></button>
                </div>
               
                <div class="modal-body w-100">
                    <div class="p-2 text-white text-muted bg-light">
                        <strong>Horario disponibles</strong>
                        
                    </div>
                    <br>
                     <!-- Indicaciones -->
                    <div class="mb-4">
                    <h6 class="fw-bold">Indicaciones para la cita</h6>
                    <p>
                        Antes de seleccionar la hora de su cita, considere en las 48 horas previas: No haber tenido relaciones, no haber realizado duchas vaginales, no haberse aplicado ningún tratamiento médico vaginal (óvulos, cremas o pomadas).<br><br>
                    ¿Tienes problemas para acceder? En caso de presentarse alguna duda, error o requerir asistencia relacionada con el acceso, comunícate a las extensiones 5506 y 5516 del Departamento de Desarrollo y Actualización Tecnológica.</p>
                    </div>

                    <!-- Formulario en filas de 2 columnas -->
                    <div class="row">
                    <!-- Horario -->
                    <div class="col-md-12 mb-3">
                        <label for="hora" class="form-label">Horario</label>
                        <select
                        id="hora"
                        class="form-select"
                        [(ngModel)]="horaSeleccionada2"
                        name="hora"
                        (change)="onHoraChange()"
                        >
                        <option [ngValue]="null" disabled selected>-- Selecciona un horario --</option>
                        <option *ngFor="let horario of horarios" [ngValue]="horario.horario_id">
                            {{ horario.horario_texto }}
                        </option>
                        </select>
                    </div>

                    <!-- Sede
                    <div class="col-md-6 mb-3" *ngIf="sedesDisponibles2.length > 0">
                        <label for="sede" class="form-label">Sede</label>
                        <select
                        id="sede"
                        class="form-select"
                        [(ngModel)]="sedeSeleccionada"
                        name="sede"
                        >
                        <option [ngValue]="null" disabled selected>-- Selecciona una sede --</option>
                        <option *ngFor="let sede of sedesDisponibles2" [ngValue]="sede.sede_id">
                            {{ sede.sede_texto }}
                        </option>
                        </select>
                    </div> -->

                    <!-- Correo -->
                    <div class="col-md-6 mb-3">
                        <label for="correo" class="form-label">Correo electrónico</label>
                        <input
                        id="correo"
                        type="email"
                        class="form-control"
                        [(ngModel)]="correoUsuario"
                        name="correo"
                        placeholder="ejemplo@dominio.com"
                        required
                        />
                    </div>

                    <!-- Confirmar correo -->
                    <div class="col-md-6 mb-3">
                        <label for="confirmarCorreo" class="form-label">Confirmar correo electrónico</label>
                        <input
                        id="confirmarCorreo"
                        type="email"
                        class="form-control"
                        [(ngModel)]="correoConfirmado"
                        name="correoConfirmado"
                        placeholder="ejemplo@dominio.com"
                        required
                        />
                    </div>

                    <!-- Teléfono -->
                    <div class="col-md-6 mb-3">
                        <label for="telefono" class="form-label">Teléfono</label>
                        <input
                        id="telefono"
                        type="number"
                        class="form-control"
                        [(ngModel)]="telefonoUsuario"
                        name="telefono"
                        pattern="[0-9]{10}"
                        placeholder="10 dígitos"
                        maxlength="10"
                        required
                        />
                    </div>

                    <!-- Confirmar teléfono -->
                    <div class="col-md-6 mb-3">
                        <label for="confirmarTelefono" class="form-label">Confirmar teléfono</label>
                        <input
                        id="confirmarTelefono"
                        type="number"
                        class="form-control"
                        [(ngModel)]="telefonoConfirmado"
                        name="telefonoConfirmado"
                        pattern="[0-9]{10}"
                        placeholder="10 dígitos"
                        maxlength="10"
                        required
                        />
                    </div>
                    </div>



                    <button
                    class="btn btn-primary mt-3"
                    (click)="guardarSeleccion()"
                    [disabled]="!horaSeleccionada2  || !correoUsuario || !telefonoUsuario || enviandoRegistro === 1"
                    >
                    <ng-container *ngIf="enviandoRegistro === 1; else iconoGuardar">
                        <span class="spinner-border spinner-border-sm me-1" role="status"></span>
                        Registrando
                    </ng-container>
                    <ng-template #iconoGuardar>
                       Guardar selección
                    </ng-template>
                    
                    </button>

                
                </div>
                <div class="modal-footer">
                    <button type="button" id="focus-target" class="btn btn-secondary"
                        (click)="modal.close('by: close button')">Cerrar</button>
                </div>
            </ng-template>  
      </div>
       

    </div>
  </div>
</div>