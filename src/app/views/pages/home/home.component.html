<div class="xmas-landing">

  <!-- Decoraciones de las esquinas -->
  <!-- <img class="xmas-decoration deco-top-left"
       src="images/navidad/superior izquierda.png"
       alt="DecoraciÃ³n navideÃ±a" />

  <img class="xmas-decoration deco-bottom-left"
       src="images/navidad/inferior izquierda.png"
       alt="DecoraciÃ³n navideÃ±a" />

  <img class="xmas-decoration deco-bottom-right"
       src="images/navidad/inferior derecha.png"
       alt="DecoraciÃ³n navideÃ±a" /> -->

  <!-- ============================================ -->
  <!-- VISTA ADMIN (tipo = 1) -->
  <!-- ============================================ -->
  <div *ngIf="tipo === 1" class="xmas-inner admin-view">
    
    <header class="xmas-header">
      <div class="xmas-logos">
        <!-- <img src="images/navidad/logos.png" alt="Escudo" /> -->
      </div>
      <h1 class="admin-title">Panel de AdministraciÃ³n - Sorteo NavideÃ±o 2025</h1>
    </header>

    <main class="xmas-main admin-main">
      
      <!-- Controles del sorteo -->
      <div class="admin-controls">
        <button 
          class="btn-sorteo" 
          (click)="sorteo()"
          [disabled]="cargandoSorteo">
          <span *ngIf="!cargandoSorteo">ğŸ² Realizar Sorteo</span>
          <span *ngIf="cargandoSorteo">â³ Sorteando...</span>
        </button>

        <button 
          class="btn-limpiar" 
          (click)="limpiarResultado()"
          [disabled]="!mostrandoResultado">
          ğŸ§¹ Limpiar Pantalla PÃºblica
        </button>
      </div>

      <!-- Resultado actual -->
      <div class="resultado-actual" *ngIf="resultadoActual && mostrandoResultado">
        <h3>ğŸ Resultado Actual en Pantalla:</h3>
        <div class="resultado-card">
     <img 
  [src]="'images/navidad/regalos/' + (resultadoActual?.id || 0) + '.jpg'" 
  [alt]="resultadoActual?.premio || 'Premio'"
  class="premio-preview" />
          <div class="resultado-info">
            <h4>{{ resultadoActual?.premio }}</h4>
            <!-- <p class="ganador" *ngIf="resultadoActual?.ganador">
              ğŸ‘¤ Ganador: <strong>{{ resultadoActual.ganador }}</strong>
            </p>
            <p class="ganador" *ngIf="!resultadoActual?.ganador">
              ğŸ‘¤ Ganador: <strong>Por asignar</strong>
            </p> -->
            <p class="cantidad">Cantidad: {{ resultadoActual?.cantidad }}</p>
          </div>
        </div>
      </div>

      <!-- Mensaje si no hay resultado -->
      <div class="no-resultado" *ngIf="!resultadoActual || !mostrandoResultado">
        <p>ğŸ‘† Presiona "Realizar Sorteo" para comenzar</p>
      </div>

      <!-- Historial de ganadores -->
      <div class="historial-section">
        <div class="historial-header">
          <h3>ğŸ“‹ Historial de Ganadores</h3>
          <button 
            class="btn-limpiar-historial" 
            (click)="reportePDF()">
            PDF
          </button>
          <button 
            class="btn-limpiar-historial" 
            (click)="limpiarHistorial()"
            *ngIf="historialGanadores.length > 0">
            ğŸ—‘ï¸ Limpiar Historial
          </button>
        </div>

        <div class="tabla-container" *ngIf="historialGanadores.length > 0">
          <table class="tabla-ganadores">
            <thead>
              <tr>
                <th>#</th>
                <th>Ganador</th>
                <th>Premio</th>
                <th>Cantidad</th>
                <th>Fecha</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let ganador of historialGanadores; let i = index">
                <td>{{ historialGanadores.length - i }}</td>
                <td>
                  <strong>{{ ganador.ganador || 'Por asignar' }}</strong>
                </td>
                <td>{{ ganador.premio }}</td>
                <td>{{ ganador.cantidad }}</td>
                <td>{{ ganador.createdAt | date:'short' }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="no-historial" *ngIf="historialGanadores.length === 0">
          <p>ğŸ“­ No hay sorteos realizados aÃºn</p>
        </div>
      </div>

    </main>
  </div>

  <!-- ============================================ -->
  <!-- VISTA PÃšBLICA (tipo = 0) -->
  <!-- ============================================ -->
  <div *ngIf="tipo === 0" class="xmas-inner public-view">
    
    <header class="xmas-header">
      <div class="xmas-logos">
        <!-- <img src="images/navidad/logos.png" alt="Escudo" /> -->
      </div>
    </header>

    <main class="xmas-main public-main">
      
      <!-- DEBUG: Muestra el estado actual 
      <div style="position: fixed; top: 10px; right: 10px; background: yellow; padding: 10px; z-index: 9999; font-size: 12px;">
        <div>mostrandoResultado: {{ mostrandoResultado }}</div>
        <div>resultadoActual: {{ resultadoActual ? 'SI' : 'NO' }}</div>
        <div>ID: {{ resultadoActual?.id }}</div>
      </div>-->
      
      <!-- Gif de espera (cuando NO hay resultado o NO se estÃ¡ mostrando) -->
       
      <div class="xmas-gif-wrapper" *ngIf="!mostrandoResultado || !resultadoActual">
        <div class="xmas-text">
          <p class="xmas-badge">{{ totalPremios }}</p>
          <h1 class="xmas-title"></h1>
          <!-- <p class="xmas-subtitle">Esperando el prÃ³ximo sorteo...</p> -->
        </div>
        <img src="images/gifs/tombolaBl.gif"
             alt="Premios de fin de aÃ±o"
             class="xmas-gif" />
      </div>

      <!-- Resultado del sorteo (cuando SÃ hay resultado Y se estÃ¡ mostrando) -->
      <div class="premio-ganador" *ngIf="mostrandoResultado && resultadoActual">
        <p class="xmas-badge">{{ totalPremios }}</p>
        <div class="ganador-nombre" *ngIf="resultadoActual?.ganador">
          <h1 class="ganador-text">{{ resultadoActual.ganador }}</h1>
        </div>
        
        <!-- <div class="ganador-nombre" *ngIf="!resultadoActual?.ganador">
          <h2 class="pulse-animation">Â¡Tenemos un ganador!</h2>
        </div> -->

        <div >
        <img 
          [src]="'images/navidad/regalos/' + (resultadoActual?.id || 0) + '.jpg'" 
          [alt]="resultadoActual?.premio || 'Premio'"
          class="premio-imagen bounce-animation"  class="xmas-gif"/>
          
          <!-- <div class="premio-nombre">
            <h3>{{ resultadoActual?.premio }}</h3>
           <p class="cantidad-badge" *ngIf="resultadoActual?.cantidad && resultadoActual.cantidad > 1">
              Cantidad: {{ resultadoActual.cantidad }}
            </p> 
          </div> -->
        </div>
      </div>

    </main>
  </div>

</div>